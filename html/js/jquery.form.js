!function(e){e.fn.ajaxSubmit=function(t){function n(){function n(){if(!h++){c.detachEvent?c.detachEvent("onload",n):c.removeEventListener("load",n,!1);var t=!0;try{if(d)throw"timeout";var a,s;if(s=c.contentWindow?c.contentWindow.document:c.contentDocument?c.contentDocument:c.document,f.responseText=s.body?s.body.innerHTML:null,f.responseXML=s.XMLDocument?s.XMLDocument:s,f.getResponseHeader=function(e){var t={"content-type":i.dataType};return t[e]},"json"==i.dataType||"script"==i.dataType){var o=s.getElementsByTagName("textarea")[0];f.responseText=o?o.value:f.responseText}else"xml"!=i.dataType||f.responseXML||null==f.responseText||(f.responseXML=r(f.responseText));a=e.httpData(f,i.dataType)}catch(l){t=!1,e.handleError(i,f,"error",l)}t&&(i.success(a,"success"),m&&e.event.trigger("ajaxSuccess",[f,i])),m&&e.event.trigger("ajaxComplete",[f,i]),m&&!--e.active&&e.event.trigger("ajaxStop"),i.complete&&i.complete(f,t?"success":"error"),setTimeout(function(){u.remove(),f.responseXML=null},100)}}function r(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&"parsererror"!=t.documentElement.tagName?t:null}var a=o[0],i=e.extend({},e.ajaxSettings,t),s="jqFormIO"+(new Date).getTime(),u=e('<iframe id="'+s+'" name="'+s+'" />'),c=u[0],l=e.browser.opera&&window.opera.version()<9;(e.browser.msie||l)&&(c.src='javascript:false;document.write("");'),u.css({position:"absolute",top:"-1000px",left:"-1000px"});var f={responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){}},m=i.global;m&&!e.active++&&e.event.trigger("ajaxStart"),m&&e.event.trigger("ajaxSend",[f,i]);var h=0,d=0;setTimeout(function(){var e=a.encoding?"encoding":"enctype",t=o.attr("target"),r=o.attr("action");o.attr({target:s,method:"POST",action:i.url}),a[e]="multipart/form-data",i.timeout&&setTimeout(function(){d=!0,n()},i.timeout),u.appendTo("body"),c.attachEvent?c.attachEvent("onload",n):c.addEventListener("load",n,!1),a.submit(),o.attr({action:r,target:t})},10)}"function"==typeof t&&(t={success:t}),t=e.extend({url:this.attr("action")||window.location.toString(),type:this.attr("method")||"GET"},t||{});var r={};if(this.trigger("form-pre-serialize",[this,t,r]),r.veto)return this;var a=this.formToArray(t.semantic);if(t.data)for(var i in t.data)a.push({name:i,value:t.data[i]});if(t.beforeSubmit&&t.beforeSubmit(a,this,t)===!1)return this;if(this.trigger("form-submit-validate",[a,this,t,r]),r.veto)return this;var s=e.param(a);"GET"==t.type.toUpperCase()?(t.url+=(t.url.indexOf("?")>=0?"&":"?")+s,t.data=null):t.data=s;var o=this,u=[];if(t.resetForm&&u.push(function(){o.resetForm()}),t.clearForm&&u.push(function(){o.clearForm()}),!t.dataType&&t.target){var c=t.success||function(){};u.push(function(n){e(t.target).html(n).each(c,arguments)})}else t.success&&u.push(t.success);t.success=function(e,t){for(var n=0,r=u.length;r>n;n++)u[n](e,t,o)};for(var l=e("input:file",this).fieldValue(),f=!1,m=0;m<l.length;m++)l[m]&&(f=!0);return t.iframe||f?e.browser.safari&&t.closeKeepAlive?e.get(t.closeKeepAlive,n):n():e.ajax(t),this.trigger("form-submit-notify",[this,t]),this},e.fn.ajaxForm=function(t){return this.ajaxFormUnbind().bind("submit.form-plugin",function(){return e(this).ajaxSubmit(t),!1}).each(function(){e(":submit,input:image",this).bind("click.form-plugin",function(t){var n=this.form;if(n.clk=this,"image"==this.type)if(void 0!=t.offsetX)n.clk_x=t.offsetX,n.clk_y=t.offsetY;else if("function"==typeof e.fn.offset){var r=e(this).offset();n.clk_x=t.pageX-r.left,n.clk_y=t.pageY-r.top}else n.clk_x=t.pageX-this.offsetLeft,n.clk_y=t.pageY-this.offsetTop;setTimeout(function(){n.clk=n.clk_x=n.clk_y=null},10)})})},e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin"),this.each(function(){e(":submit,input:image",this).unbind("click.form-plugin")})},e.fn.formToArray=function(t){var n=[];if(0==this.length)return n;var r=this[0],a=t?r.getElementsByTagName("*"):r.elements;if(!a)return n;for(var i=0,s=a.length;s>i;i++){var o=a[i],u=o.name;if(u)if(t&&r.clk&&"image"==o.type)o.disabled||r.clk!=o||n.push({name:u+".x",value:r.clk_x},{name:u+".y",value:r.clk_y});else{var c=e.fieldValue(o,!0);if(c&&c.constructor==Array)for(var l=0,f=c.length;f>l;l++)n.push({name:u,value:c[l]});else null!==c&&"undefined"!=typeof c&&n.push({name:u,value:c})}}if(!t&&r.clk)for(var m=r.getElementsByTagName("input"),i=0,s=m.length;s>i;i++){var h=m[i],u=h.name;u&&!h.disabled&&"image"==h.type&&r.clk==h&&n.push({name:u+".x",value:r.clk_x},{name:u+".y",value:r.clk_y})}return n},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var n=[];return this.each(function(){var r=this.name;if(r){var a=e.fieldValue(this,t);if(a&&a.constructor==Array)for(var i=0,s=a.length;s>i;i++)n.push({name:r,value:a[i]});else null!==a&&"undefined"!=typeof a&&n.push({name:this.name,value:a})}}),e.param(n)},e.fn.fieldValue=function(t){for(var n=[],r=0,a=this.length;a>r;r++){var i=this[r],s=e.fieldValue(i,t);null===s||"undefined"==typeof s||s.constructor==Array&&!s.length||(s.constructor==Array?e.merge(n,s):n.push(s))}return n},e.fieldValue=function(t,n){var r=t.name,a=t.type,i=t.tagName.toLowerCase();if("undefined"==typeof n&&(n=!0),n&&(!r||t.disabled||"reset"==a||"button"==a||("checkbox"==a||"radio"==a)&&!t.checked||("submit"==a||"image"==a)&&t.form&&t.form.clk!=t||"select"==i&&-1==t.selectedIndex))return null;if("select"==i){var s=t.selectedIndex;if(0>s)return null;for(var o=[],u=t.options,c="select-one"==a,l=c?s+1:u.length,f=c?s:0;l>f;f++){var m=u[f];if(m.selected){var h=e.browser.msie&&!m.attributes.value.specified?m.text:m.value;if(c)return h;o.push(h)}}return o}return t.value},e.fn.clearForm=function(){return this.each(function(){e("input,select,textarea",this).clearFields()})},e.fn.clearFields=e.fn.clearInputs=function(){return this.each(function(){var e=this.type,t=this.tagName.toLowerCase();"text"==e||"password"==e||"textarea"==t?this.value="":"checkbox"==e||"radio"==e?this.checked=!1:"select"==t&&(this.selectedIndex=-1)})},e.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},e.fn.enable=function(e){return void 0==e&&(e=!0),this.each(function(){this.disabled=!e})},e.fn.select=function(t){return void 0==t&&(t=!0),this.each(function(){var n=this.type;if("checkbox"==n||"radio"==n)this.checked=t;else if("option"==this.tagName.toLowerCase()){var r=e(this).parent("select");t&&r[0]&&"select-one"==r[0].type&&r.find("option").select(!1),this.selected=t}})}}(jQuery);